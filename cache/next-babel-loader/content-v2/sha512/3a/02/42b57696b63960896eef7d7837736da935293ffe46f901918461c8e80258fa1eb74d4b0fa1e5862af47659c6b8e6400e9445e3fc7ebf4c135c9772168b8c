{"ast":null,"code":"import { jsxs as _jsxs } from \"react/jsx-runtime\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nimport React, { useState } from \"react\";\nimport Head from \"next/head\";\nimport { useAsync } from \"react-use\";\nimport { useRouter } from \"next/router\";\nimport { useWallet } from \"use-wallet\";\nimport { useForm } from \"react-hook-form\";\nimport { Flex, Box, FormControl, FormLabel, Input, Stack, Button, Heading, Text, useColorModeValue, InputRightAddon, InputGroup, Alert, AlertIcon, AlertDescription, FormHelperText, Textarea } from \"@chakra-ui/react\";\nimport NextLink from \"next/link\";\nimport { ArrowBackIcon } from \"@chakra-ui/icons\";\nimport { getETHPrice, getETHPriceInUSD } from \"../../lib/getETHPrice\";\nimport factory from \"../../smart-contract/factory\";\nimport web3 from \"../../smart-contract/web3\";\nexport default function NewCampaign() {\n  const {\n    handleSubmit,\n    register,\n    formState: {\n      isSubmitting,\n      errors\n    }\n  } = useForm({\n    mode: \"onChange\"\n  });\n  const router = useRouter();\n  const {\n    0: error,\n    1: setError\n  } = useState(\"\");\n  const wallet = useWallet();\n  const {\n    0: minContriInUSD,\n    1: setMinContriInUSD\n  } = useState();\n  const {\n    0: targetInUSD,\n    1: setTargetInUSD\n  } = useState();\n  const {\n    0: ETHPrice,\n    1: setETHPrice\n  } = useState(0);\n  useAsync(async () => {\n    try {\n      const result = await getETHPrice();\n      setETHPrice(result);\n    } catch (error) {\n      console.log(error);\n    }\n  }, []);\n\n  async function onSubmit(data) {\n    console.log(data.minimumContribution, data.campaignName, data.description, data.imageUrl, data.target);\n\n    try {\n      const accounts = await web3.eth.getAccounts();\n      await factory.methods.createCampaign(web3.utils.toWei(data.minimumContribution, \"ether\"), data.campaignName, data.description, data.imageUrl, web3.utils.toWei(data.target, \"ether\")).send({\n        from: accounts[0]\n      });\n      router.push(\"/\");\n    } catch (err) {\n      setError(err.message);\n      console.log(err);\n    }\n  }\n\n  return /*#__PURE__*/_jsxs(\"div\", {\n    children: [/*#__PURE__*/_jsxs(Head, {\n      children: [/*#__PURE__*/_jsx(\"title\", {\n        children: \"New Campaign\"\n      }), /*#__PURE__*/_jsx(\"meta\", {\n        name: \"description\",\n        content: \"Create New Campaign\"\n      }), /*#__PURE__*/_jsx(\"link\", {\n        rel: \"icon\",\n        href: \"/logo.svg\"\n      })]\n    }), /*#__PURE__*/_jsx(\"main\", {\n      children: /*#__PURE__*/_jsxs(Stack, {\n        spacing: 8,\n        mx: \"auto\",\n        maxW: \"2xl\",\n        py: 12,\n        px: 6,\n        children: [/*#__PURE__*/_jsxs(Text, {\n          fontSize: \"lg\",\n          color: \"teal.400\",\n          children: [/*#__PURE__*/_jsx(ArrowBackIcon, {\n            mr: 2\n          }), /*#__PURE__*/_jsx(NextLink, {\n            href: \"/\",\n            children: \" Back to Home\"\n          })]\n        }), /*#__PURE__*/_jsx(Stack, {\n          children: /*#__PURE__*/_jsx(Heading, {\n            fontSize: \"4xl\",\n            children: \"Create a New Campaign \\uD83D\\uDCE2\"\n          })\n        }), /*#__PURE__*/_jsx(Box, {\n          rounded: \"lg\",\n          bg: useColorModeValue(\"white\", \"gray.700\"),\n          boxShadow: \"lg\",\n          p: 8,\n          children: /*#__PURE__*/_jsx(\"form\", {\n            onSubmit: handleSubmit(onSubmit),\n            children: /*#__PURE__*/_jsxs(Stack, {\n              spacing: 4,\n              children: [/*#__PURE__*/_jsxs(FormControl, {\n                id: \"minimumContribution\",\n                children: [/*#__PURE__*/_jsx(FormLabel, {\n                  children: \"Minimum Contribution Amount\"\n                }), /*#__PURE__*/_jsxs(InputGroup, {\n                  children: [\" \", /*#__PURE__*/_jsx(Input, _objectSpread(_objectSpread({\n                    type: \"number\",\n                    step: \"any\"\n                  }, register(\"minimumContribution\", {\n                    required: true\n                  })), {}, {\n                    isDisabled: isSubmitting,\n                    onChange: e => {\n                      setMinContriInUSD(Math.abs(e.target.value));\n                    }\n                  })), \" \", /*#__PURE__*/_jsx(InputRightAddon, {\n                    children: \"BNB\"\n                  })]\n                }), minContriInUSD ? /*#__PURE__*/_jsxs(FormHelperText, {\n                  children: [\"~$ \", getETHPriceInUSD(ETHPrice, minContriInUSD)]\n                }) : null]\n              }), /*#__PURE__*/_jsxs(FormControl, {\n                id: \"campaignName\",\n                children: [/*#__PURE__*/_jsx(FormLabel, {\n                  children: \"Campaign Name\"\n                }), /*#__PURE__*/_jsx(Input, _objectSpread(_objectSpread({}, register(\"campaignName\", {\n                  required: true\n                })), {}, {\n                  isDisabled: isSubmitting\n                }))]\n              }), /*#__PURE__*/_jsxs(FormControl, {\n                id: \"description\",\n                children: [/*#__PURE__*/_jsx(FormLabel, {\n                  children: \"Campaign Description\"\n                }), /*#__PURE__*/_jsx(Textarea, _objectSpread(_objectSpread({}, register(\"description\", {\n                  required: true\n                })), {}, {\n                  isDisabled: isSubmitting\n                }))]\n              }), /*#__PURE__*/_jsxs(FormControl, {\n                id: \"imageUrl\",\n                children: [/*#__PURE__*/_jsx(FormLabel, {\n                  children: \"Image URL\"\n                }), /*#__PURE__*/_jsx(Input, _objectSpread(_objectSpread({}, register(\"imageUrl\", {\n                  required: true\n                })), {}, {\n                  isDisabled: isSubmitting,\n                  type: \"url\"\n                }))]\n              }), /*#__PURE__*/_jsxs(FormControl, {\n                id: \"target\",\n                children: [/*#__PURE__*/_jsx(FormLabel, {\n                  children: \"Target Amount\"\n                }), /*#__PURE__*/_jsxs(InputGroup, {\n                  children: [/*#__PURE__*/_jsx(Input, _objectSpread(_objectSpread({\n                    type: \"number\",\n                    step: \"any\"\n                  }, register(\"target\", {\n                    required: true\n                  })), {}, {\n                    isDisabled: isSubmitting,\n                    onChange: e => {\n                      setTargetInUSD(Math.abs(e.target.value));\n                    }\n                  })), /*#__PURE__*/_jsx(InputRightAddon, {\n                    children: \"BNB\"\n                  })]\n                }), targetInUSD ? /*#__PURE__*/_jsxs(FormHelperText, {\n                  children: [\"~$ \", getETHPriceInUSD(ETHPrice, targetInUSD)]\n                }) : null]\n              }), error ? /*#__PURE__*/_jsxs(Alert, {\n                status: \"error\",\n                children: [/*#__PURE__*/_jsx(AlertIcon, {}), /*#__PURE__*/_jsxs(AlertDescription, {\n                  mr: 2,\n                  children: [\" \", error]\n                })]\n              }) : null, errors.minimumContribution || errors.name || errors.description || errors.imageUrl || errors.target ? /*#__PURE__*/_jsxs(Alert, {\n                status: \"error\",\n                children: [/*#__PURE__*/_jsx(AlertIcon, {}), /*#__PURE__*/_jsxs(AlertDescription, {\n                  mr: 2,\n                  children: [\" \", \"All Fields are Required\"]\n                })]\n              }) : null, /*#__PURE__*/_jsx(Stack, {\n                spacing: 10,\n                children: wallet.status === \"connected\" ? /*#__PURE__*/_jsx(Button, {\n                  bg: \"teal.400\",\n                  color: \"white\",\n                  _hover: {\n                    bg: \"teal.500\"\n                  },\n                  isLoading: isSubmitting,\n                  type: \"submit\",\n                  children: \"Create\"\n                }) : /*#__PURE__*/_jsxs(Stack, {\n                  spacing: 3,\n                  children: [/*#__PURE__*/_jsxs(Button, {\n                    color: \"white\",\n                    bg: \"teal.400\",\n                    _hover: {\n                      bg: \"teal.300\"\n                    },\n                    onClick: () => wallet.connect(),\n                    children: [\"Connect Wallet\", \" \"]\n                  }), /*#__PURE__*/_jsxs(Alert, {\n                    status: \"warning\",\n                    children: [/*#__PURE__*/_jsx(AlertIcon, {}), /*#__PURE__*/_jsx(AlertDescription, {\n                      mr: 2,\n                      children: \"Please Connect Your Wallet First to Create a Campaign\"\n                    })]\n                  })]\n                })\n              })]\n            })\n          })\n        })]\n      })\n    })]\n  });\n}","map":null,"metadata":{},"sourceType":"module"}