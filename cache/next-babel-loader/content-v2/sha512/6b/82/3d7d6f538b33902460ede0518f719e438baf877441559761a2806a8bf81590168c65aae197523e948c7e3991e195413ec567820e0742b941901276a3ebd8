{"ast":null,"code":"import _defineProperty from \"D:/adit/bnbdonasi/node_modules/next/node_modules/@babel/runtime/helpers/esm/defineProperty\";\nimport { jsxs as _jsxs } from \"react/jsx-runtime\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport _regeneratorRuntime from \"D:/adit/bnbdonasi/node_modules/next/node_modules/@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"D:/adit/bnbdonasi/node_modules/next/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nimport React, { useState } from \"react\";\nimport Head from \"next/head\";\nimport { useAsync } from \"react-use\";\nimport { useRouter } from \"next/router\";\nimport { useWallet } from \"use-wallet\";\nimport { useForm } from \"react-hook-form\";\nimport { Flex, Box, FormControl, FormLabel, Input, Stack, Button, Heading, Text, useColorModeValue, InputRightAddon, InputGroup, Alert, AlertIcon, AlertDescription, FormHelperText, Textarea } from \"@chakra-ui/react\";\nimport NextLink from \"next/link\";\nimport { ArrowBackIcon } from \"@chakra-ui/icons\";\nimport { getETHPrice, getETHPriceInUSD } from \"../../lib/getETHPrice\";\nimport factory from \"../../smart-contract/factory\";\nimport web3 from \"../../smart-contract/web3\";\nexport default function NewCampaign() {\n  var _useForm = useForm({\n    mode: \"onChange\"\n  }),\n      handleSubmit = _useForm.handleSubmit,\n      register = _useForm.register,\n      _useForm$formState = _useForm.formState,\n      isSubmitting = _useForm$formState.isSubmitting,\n      errors = _useForm$formState.errors;\n\n  var router = useRouter();\n\n  var _useState = useState(\"\"),\n      error = _useState[0],\n      setError = _useState[1];\n\n  var wallet = useWallet();\n\n  var _useState2 = useState(),\n      minContriInUSD = _useState2[0],\n      setMinContriInUSD = _useState2[1];\n\n  var _useState3 = useState(),\n      targetInUSD = _useState3[0],\n      setTargetInUSD = _useState3[1];\n\n  var _useState4 = useState(0),\n      ETHPrice = _useState4[0],\n      setETHPrice = _useState4[1];\n\n  useAsync( /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee() {\n    var result;\n    return _regeneratorRuntime.wrap(function _callee$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            _context.prev = 0;\n            _context.next = 3;\n            return getETHPrice();\n\n          case 3:\n            result = _context.sent;\n            setETHPrice(result);\n            _context.next = 10;\n            break;\n\n          case 7:\n            _context.prev = 7;\n            _context.t0 = _context[\"catch\"](0);\n            console.log(_context.t0);\n\n          case 10:\n          case \"end\":\n            return _context.stop();\n        }\n      }\n    }, _callee, null, [[0, 7]]);\n  })), []);\n\n  function onSubmit(_x) {\n    return _onSubmit.apply(this, arguments);\n  }\n\n  function _onSubmit() {\n    _onSubmit = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2(data) {\n      var accounts;\n      return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n        while (1) {\n          switch (_context2.prev = _context2.next) {\n            case 0:\n              console.log(data.minimumContribution, data.campaignName, data.description, data.imageUrl, data.target);\n              _context2.prev = 1;\n              _context2.next = 4;\n              return web3.eth.getAccounts();\n\n            case 4:\n              accounts = _context2.sent;\n              _context2.next = 7;\n              return factory.methods.createCampaign(web3.utils.toWei(data.minimumContribution, \"ether\"), data.campaignName, data.description, data.imageUrl, web3.utils.toWei(data.target, \"ether\")).send({\n                from: accounts[0]\n              });\n\n            case 7:\n              router.push(\"/\");\n              _context2.next = 14;\n              break;\n\n            case 10:\n              _context2.prev = 10;\n              _context2.t0 = _context2[\"catch\"](1);\n              setError(_context2.t0.message);\n              console.log(_context2.t0);\n\n            case 14:\n            case \"end\":\n              return _context2.stop();\n          }\n        }\n      }, _callee2, null, [[1, 10]]);\n    }));\n    return _onSubmit.apply(this, arguments);\n  }\n\n  return /*#__PURE__*/_jsxs(\"div\", {\n    children: [/*#__PURE__*/_jsxs(Head, {\n      children: [/*#__PURE__*/_jsx(\"title\", {\n        children: \"New Campaign\"\n      }), /*#__PURE__*/_jsx(\"meta\", {\n        name: \"description\",\n        content: \"Create New Campaign\"\n      }), /*#__PURE__*/_jsx(\"link\", {\n        rel: \"icon\",\n        href: \"/logo.svg\"\n      })]\n    }), /*#__PURE__*/_jsx(\"main\", {\n      children: /*#__PURE__*/_jsxs(Stack, {\n        spacing: 8,\n        mx: \"auto\",\n        maxW: \"2xl\",\n        py: 12,\n        px: 6,\n        children: [/*#__PURE__*/_jsxs(Text, {\n          fontSize: \"lg\",\n          color: \"teal.400\",\n          children: [/*#__PURE__*/_jsx(ArrowBackIcon, {\n            mr: 2\n          }), /*#__PURE__*/_jsx(NextLink, {\n            href: \"/\",\n            children: \" Back to Home\"\n          })]\n        }), /*#__PURE__*/_jsx(Stack, {\n          children: /*#__PURE__*/_jsx(Heading, {\n            fontSize: \"4xl\",\n            children: \"Create a New Campaign \\uD83D\\uDCE2\"\n          })\n        }), /*#__PURE__*/_jsx(Box, {\n          rounded: \"lg\",\n          bg: useColorModeValue(\"white\", \"gray.700\"),\n          boxShadow: \"lg\",\n          p: 8,\n          children: /*#__PURE__*/_jsx(\"form\", {\n            onSubmit: handleSubmit(onSubmit),\n            children: /*#__PURE__*/_jsxs(Stack, {\n              spacing: 4,\n              children: [/*#__PURE__*/_jsxs(FormControl, {\n                id: \"minimumContribution\",\n                children: [/*#__PURE__*/_jsx(FormLabel, {\n                  children: \"Minimum Contribution Amount\"\n                }), /*#__PURE__*/_jsxs(InputGroup, {\n                  children: [\" \", /*#__PURE__*/_jsx(Input, _objectSpread(_objectSpread({\n                    type: \"number\",\n                    step: \"any\"\n                  }, register(\"minimumContribution\", {\n                    required: true\n                  })), {}, {\n                    isDisabled: isSubmitting,\n                    onChange: function onChange(e) {\n                      setMinContriInUSD(Math.abs(e.target.value));\n                    }\n                  })), \" \", /*#__PURE__*/_jsx(InputRightAddon, {\n                    children: \"BNB\"\n                  })]\n                }), minContriInUSD ? /*#__PURE__*/_jsxs(FormHelperText, {\n                  children: [\"~$ \", getETHPriceInUSD(ETHPrice, minContriInUSD)]\n                }) : null]\n              }), /*#__PURE__*/_jsxs(FormControl, {\n                id: \"campaignName\",\n                children: [/*#__PURE__*/_jsx(FormLabel, {\n                  children: \"Campaign Name\"\n                }), /*#__PURE__*/_jsx(Input, _objectSpread(_objectSpread({}, register(\"campaignName\", {\n                  required: true\n                })), {}, {\n                  isDisabled: isSubmitting\n                }))]\n              }), /*#__PURE__*/_jsxs(FormControl, {\n                id: \"description\",\n                children: [/*#__PURE__*/_jsx(FormLabel, {\n                  children: \"Campaign Description\"\n                }), /*#__PURE__*/_jsx(Textarea, _objectSpread(_objectSpread({}, register(\"description\", {\n                  required: true\n                })), {}, {\n                  isDisabled: isSubmitting\n                }))]\n              }), /*#__PURE__*/_jsxs(FormControl, {\n                id: \"imageUrl\",\n                children: [/*#__PURE__*/_jsx(FormLabel, {\n                  children: \"Image URL\"\n                }), /*#__PURE__*/_jsx(Input, _objectSpread(_objectSpread({}, register(\"imageUrl\", {\n                  required: true\n                })), {}, {\n                  isDisabled: isSubmitting,\n                  type: \"url\"\n                }))]\n              }), /*#__PURE__*/_jsxs(FormControl, {\n                id: \"target\",\n                children: [/*#__PURE__*/_jsx(FormLabel, {\n                  children: \"Target Amount\"\n                }), /*#__PURE__*/_jsxs(InputGroup, {\n                  children: [/*#__PURE__*/_jsx(Input, _objectSpread(_objectSpread({\n                    type: \"number\",\n                    step: \"any\"\n                  }, register(\"target\", {\n                    required: true\n                  })), {}, {\n                    isDisabled: isSubmitting,\n                    onChange: function onChange(e) {\n                      setTargetInUSD(Math.abs(e.target.value));\n                    }\n                  })), /*#__PURE__*/_jsx(InputRightAddon, {\n                    children: \"BNB\"\n                  })]\n                }), targetInUSD ? /*#__PURE__*/_jsxs(FormHelperText, {\n                  children: [\"~$ \", getETHPriceInUSD(ETHPrice, targetInUSD)]\n                }) : null]\n              }), error ? /*#__PURE__*/_jsxs(Alert, {\n                status: \"error\",\n                children: [/*#__PURE__*/_jsx(AlertIcon, {}), /*#__PURE__*/_jsxs(AlertDescription, {\n                  mr: 2,\n                  children: [\" \", error]\n                })]\n              }) : null, errors.minimumContribution || errors.name || errors.description || errors.imageUrl || errors.target ? /*#__PURE__*/_jsxs(Alert, {\n                status: \"error\",\n                children: [/*#__PURE__*/_jsx(AlertIcon, {}), /*#__PURE__*/_jsxs(AlertDescription, {\n                  mr: 2,\n                  children: [\" \", \"All Fields are Required\"]\n                })]\n              }) : null, /*#__PURE__*/_jsx(Stack, {\n                spacing: 10,\n                children: wallet.status === \"connected\" ? /*#__PURE__*/_jsx(Button, {\n                  bg: \"teal.400\",\n                  color: \"white\",\n                  _hover: {\n                    bg: \"teal.500\"\n                  },\n                  isLoading: isSubmitting,\n                  type: \"submit\",\n                  children: \"Create\"\n                }) : /*#__PURE__*/_jsxs(Stack, {\n                  spacing: 3,\n                  children: [/*#__PURE__*/_jsxs(Button, {\n                    color: \"white\",\n                    bg: \"teal.400\",\n                    _hover: {\n                      bg: \"teal.300\"\n                    },\n                    onClick: function onClick() {\n                      return wallet.connect();\n                    },\n                    children: [\"Connect Wallet\", \" \"]\n                  }), /*#__PURE__*/_jsxs(Alert, {\n                    status: \"warning\",\n                    children: [/*#__PURE__*/_jsx(AlertIcon, {}), /*#__PURE__*/_jsx(AlertDescription, {\n                      mr: 2,\n                      children: \"Please Connect Your Wallet First to Create a Campaign\"\n                    })]\n                  })]\n                })\n              })]\n            })\n          })\n        })]\n      })\n    })]\n  });\n}","map":null,"metadata":{},"sourceType":"module"}