{"ast":null,"code":"import { jsxs as _jsxs } from \"react/jsx-runtime\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nimport Head from \"next/head\";\nimport NextLink from \"next/link\";\nimport { ArrowBackIcon } from \"@chakra-ui/icons\";\nimport { useWallet } from \"use-wallet\";\nimport { useForm } from \"react-hook-form\";\nimport { useRouter } from \"next/router\";\nimport { useState } from \"react\";\nimport { getETHPrice, getETHPriceInUSD } from \"../../../../lib/getETHPrice\";\nimport { Box, FormControl, FormLabel, Input, Stack, Button, Heading, Text, useColorModeValue, InputRightAddon, InputGroup, Alert, AlertIcon, AlertDescription, FormErrorMessage, FormHelperText, Textarea } from \"@chakra-ui/react\";\nimport web3 from \"../../../../smart-contract/web3\";\nimport Campaign from \"../../../../smart-contract/campaign\";\nimport { useAsync } from \"react-use\";\nexport default function NewRequest() {\n  const router = useRouter();\n  const {\n    id\n  } = router.query;\n  const {\n    handleSubmit,\n    register,\n    formState: {\n      isSubmitting,\n      errors\n    }\n  } = useForm({\n    mode: \"onChange\"\n  });\n  const {\n    0: error,\n    1: setError\n  } = useState(\"\");\n  const {\n    0: inUSD,\n    1: setInUSD\n  } = useState();\n  const {\n    0: ETHPrice,\n    1: setETHPrice\n  } = useState(0);\n  const wallet = useWallet();\n  useAsync(async () => {\n    try {\n      const result = await getETHPrice();\n      setETHPrice(result);\n    } catch (error) {\n      console.log(error);\n    }\n  }, []);\n\n  async function onSubmit(data) {\n    console.log(data);\n    const campaign = Campaign(id);\n\n    try {\n      const accounts = await web3.eth.getAccounts();\n      await campaign.methods.createRequest(data.description, web3.utils.toWei(data.value, \"ether\"), data.recipient).send({\n        from: accounts[0]\n      });\n      router.push(`/campaign/${id}/requests`);\n    } catch (err) {\n      setError(err.message);\n      console.log(err);\n    }\n  }\n\n  return /*#__PURE__*/_jsxs(\"div\", {\n    children: [/*#__PURE__*/_jsxs(Head, {\n      children: [/*#__PURE__*/_jsx(\"title\", {\n        children: \"Create a Withdrawal Request\"\n      }), /*#__PURE__*/_jsx(\"meta\", {\n        name: \"description\",\n        content: \"Create a Withdrawal Request\"\n      }), /*#__PURE__*/_jsx(\"link\", {\n        rel: \"icon\",\n        href: \"/logo.svg\"\n      })]\n    }), /*#__PURE__*/_jsx(\"main\", {\n      children: /*#__PURE__*/_jsxs(Stack, {\n        spacing: 8,\n        mx: \"auto\",\n        maxW: \"2xl\",\n        py: 12,\n        px: 6,\n        children: [/*#__PURE__*/_jsxs(Text, {\n          fontSize: \"lg\",\n          color: \"teal.400\",\n          justifyContent: \"center\",\n          children: [/*#__PURE__*/_jsx(ArrowBackIcon, {\n            mr: 2\n          }), /*#__PURE__*/_jsx(NextLink, {\n            href: `/campaign/${id}/requests`,\n            children: \"Back to Requests\"\n          })]\n        }), /*#__PURE__*/_jsx(Stack, {\n          children: /*#__PURE__*/_jsx(Heading, {\n            fontSize: \"4xl\",\n            children: \"Create a Withdrawal Request \\uD83D\\uDCB8\"\n          })\n        }), /*#__PURE__*/_jsx(Box, {\n          rounded: \"lg\",\n          bg: useColorModeValue(\"white\", \"gray.700\"),\n          boxShadow: \"lg\",\n          p: 8,\n          children: /*#__PURE__*/_jsx(\"form\", {\n            onSubmit: handleSubmit(onSubmit),\n            children: /*#__PURE__*/_jsxs(Stack, {\n              spacing: 4,\n              children: [/*#__PURE__*/_jsxs(FormControl, {\n                id: \"description\",\n                children: [/*#__PURE__*/_jsx(FormLabel, {\n                  children: \"Request Description\"\n                }), /*#__PURE__*/_jsx(Textarea, _objectSpread(_objectSpread({}, register(\"description\", {\n                  required: true\n                })), {}, {\n                  isDisabled: isSubmitting\n                }))]\n              }), /*#__PURE__*/_jsxs(FormControl, {\n                id: \"value\",\n                children: [/*#__PURE__*/_jsx(FormLabel, {\n                  children: \"Amount in BNB\"\n                }), /*#__PURE__*/_jsxs(InputGroup, {\n                  children: [\" \", /*#__PURE__*/_jsx(Input, _objectSpread(_objectSpread({\n                    type: \"number\"\n                  }, register(\"value\", {\n                    required: true\n                  })), {}, {\n                    isDisabled: isSubmitting,\n                    onChange: e => {\n                      setInUSD(Math.abs(e.target.value));\n                    },\n                    step: \"any\"\n                  })), \" \", /*#__PURE__*/_jsx(InputRightAddon, {\n                    children: \"BNB\"\n                  })]\n                }), inUSD ? /*#__PURE__*/_jsxs(FormHelperText, {\n                  children: [\"~$ \", getETHPriceInUSD(ETHPrice, inUSD)]\n                }) : null]\n              }), /*#__PURE__*/_jsxs(FormControl, {\n                id: \"recipient\",\n                children: [/*#__PURE__*/_jsx(FormLabel, {\n                  htmlFor: \"recipient\",\n                  children: \"Recipient Ethereum Wallet Address\"\n                }), /*#__PURE__*/_jsx(Input, _objectSpread(_objectSpread({\n                  name: \"recipient\"\n                }, register(\"recipient\", {\n                  required: true\n                })), {}, {\n                  isDisabled: isSubmitting\n                }))]\n              }), errors.description || errors.value || errors.recipient ? /*#__PURE__*/_jsxs(Alert, {\n                status: \"error\",\n                children: [/*#__PURE__*/_jsx(AlertIcon, {}), /*#__PURE__*/_jsxs(AlertDescription, {\n                  mr: 2,\n                  children: [\" \", \"All Fields are Required\"]\n                })]\n              }) : null, error ? /*#__PURE__*/_jsxs(Alert, {\n                status: \"error\",\n                children: [/*#__PURE__*/_jsx(AlertIcon, {}), /*#__PURE__*/_jsxs(AlertDescription, {\n                  mr: 2,\n                  children: [\" \", error]\n                })]\n              }) : null, /*#__PURE__*/_jsx(Stack, {\n                spacing: 10,\n                children: wallet.status === \"connected\" ? /*#__PURE__*/_jsx(Button, {\n                  bg: \"teal.400\",\n                  color: \"white\",\n                  _hover: {\n                    bg: \"teal.500\"\n                  },\n                  isLoading: isSubmitting,\n                  type: \"submit\",\n                  children: \"Create Withdrawal Request\"\n                }) : /*#__PURE__*/_jsxs(Stack, {\n                  spacing: 3,\n                  children: [/*#__PURE__*/_jsxs(Button, {\n                    color: \"white\",\n                    bg: \"teal.400\",\n                    _hover: {\n                      bg: \"teal.300\"\n                    },\n                    onClick: () => wallet.connect(),\n                    children: [\"Connect Wallet\", \" \"]\n                  }), /*#__PURE__*/_jsxs(Alert, {\n                    status: \"warning\",\n                    children: [/*#__PURE__*/_jsx(AlertIcon, {}), /*#__PURE__*/_jsx(AlertDescription, {\n                      mr: 2,\n                      children: \"Please Connect Your Wallet First to Create a Campaign\"\n                    })]\n                  })]\n                })\n              })]\n            })\n          })\n        })]\n      })\n    })]\n  });\n}","map":null,"metadata":{},"sourceType":"module"}