{"ast":null,"code":"import _regeneratorRuntime from \"D:/adit/bnbdonasi/node_modules/next/node_modules/@babel/runtime/regenerator\";\nimport _defineProperty from \"D:/adit/bnbdonasi/node_modules/next/node_modules/@babel/runtime/helpers/esm/defineProperty\";\nimport _asyncToGenerator from \"D:/adit/bnbdonasi/node_modules/next/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport { jsxs as _jsxs } from \"react/jsx-runtime\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nimport Head from \"next/head\";\nimport { useState, useEffect } from \"react\";\nimport { useWallet } from \"use-wallet\";\nimport { useForm } from \"react-hook-form\";\nimport { useRouter } from \"next/router\";\nimport { useWindowSize } from \"react-use\";\nimport { getETHPriceInUSD, getWEIPriceInUSD } from \"../../lib/getETHPrice\";\nimport { Box, Flex, Stack, Heading, Text, Container, Input, Button, SimpleGrid, InputRightAddon, InputGroup, FormControl, FormLabel, Stat, StatLabel, StatNumber, useColorModeValue, Tooltip, Alert, AlertIcon, AlertDescription, Progress, CloseButton, FormHelperText, Link } from \"@chakra-ui/react\";\nimport { InfoIcon, ExternalLinkIcon } from \"@chakra-ui/icons\";\nimport NextLink from \"next/link\";\nimport Confetti from \"react-confetti\";\nimport web3 from \"../../smart-contract/web3\";\nimport Campaign from \"../../smart-contract/campaign\";\nimport factory from \"../../smart-contract/factory\";\n\nfunction StatsCard(props) {\n  var title = props.title,\n      stat = props.stat,\n      info = props.info;\n  return /*#__PURE__*/_jsx(Stat, {\n    px: {\n      base: 2,\n      md: 4\n    },\n    py: \"5\",\n    shadow: \"sm\",\n    border: \"1px solid\",\n    borderColor: \"gray.500\",\n    rounded: \"lg\",\n    transition: \"transform 0.3s ease\",\n    _hover: {\n      transform: \"translateY(-5px)\"\n    },\n    children: /*#__PURE__*/_jsx(Tooltip, {\n      label: info,\n      bg: useColorModeValue(\"white\", \"gray.700\"),\n      placement: \"top\",\n      color: useColorModeValue(\"gray.800\", \"white\"),\n      fontSize: \"1em\",\n      children: /*#__PURE__*/_jsx(Flex, {\n        justifyContent: \"space-between\",\n        children: /*#__PURE__*/_jsxs(Box, {\n          pl: {\n            base: 2,\n            md: 4\n          },\n          children: [/*#__PURE__*/_jsx(StatLabel, {\n            fontWeight: \"medium\",\n            isTruncated: true,\n            children: title\n          }), /*#__PURE__*/_jsx(StatNumber, {\n            fontSize: \"base\",\n            fontWeight: \"bold\",\n            isTruncated: true,\n            maxW: {\n              base: \"\t10rem\",\n              sm: \"sm\"\n            },\n            children: stat\n          })]\n        })\n      })\n    })\n  });\n}\n\nexport var __N_SSP = true;\nexport default function CampaignSingle(_ref) {\n  var id = _ref.id,\n      minimumContribution = _ref.minimumContribution,\n      balance = _ref.balance,\n      requestsCount = _ref.requestsCount,\n      approversCount = _ref.approversCount,\n      manager = _ref.manager,\n      name = _ref.name,\n      description = _ref.description,\n      image = _ref.image,\n      target = _ref.target,\n      ETHPrice = _ref.ETHPrice;\n\n  var _useForm = useForm({\n    mode: \"onChange\"\n  }),\n      handleSubmit = _useForm.handleSubmit,\n      register = _useForm.register,\n      formState = _useForm.formState,\n      reset = _useForm.reset,\n      getValues = _useForm.getValues;\n\n  var _useState = useState(false),\n      isSubmitted = _useState[0],\n      setIsSubmitted = _useState[1];\n\n  var _useState2 = useState(\"\"),\n      error = _useState2[0],\n      setError = _useState2[1];\n\n  var _useState3 = useState(),\n      amountInUSD = _useState3[0],\n      setAmountInUSD = _useState3[1];\n\n  var wallet = useWallet();\n  var router = useRouter();\n\n  var _useWindowSize = useWindowSize(),\n      width = _useWindowSize.width,\n      height = _useWindowSize.height;\n\n  function onSubmit(_x) {\n    return _onSubmit.apply(this, arguments);\n  }\n\n  function _onSubmit() {\n    _onSubmit = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee(data) {\n      var campaign, accounts;\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              console.log(data);\n              _context.prev = 1;\n              campaign = Campaign(id);\n              _context.next = 5;\n              return web3.eth.getAccounts();\n\n            case 5:\n              accounts = _context.sent;\n              _context.next = 8;\n              return campaign.methods.contibute().send({\n                from: accounts[0],\n                value: web3.utils.toWei(data.value, \"ether\")\n              });\n\n            case 8:\n              router.push(\"/campaign/\".concat(id));\n              setAmountInUSD(null);\n              reset(\"\", {\n                keepValues: false\n              });\n              setIsSubmitted(true);\n              setError(false);\n              _context.next = 19;\n              break;\n\n            case 15:\n              _context.prev = 15;\n              _context.t0 = _context[\"catch\"](1);\n              setError(_context.t0.message);\n              console.log(_context.t0);\n\n            case 19:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee, null, [[1, 15]]);\n    }));\n    return _onSubmit.apply(this, arguments);\n  }\n\n  return /*#__PURE__*/_jsxs(\"div\", {\n    children: [/*#__PURE__*/_jsxs(Head, {\n      children: [/*#__PURE__*/_jsx(\"title\", {\n        children: \"Campaign Details\"\n      }), /*#__PURE__*/_jsx(\"meta\", {\n        name: \"description\",\n        content: \"Create a Withdrawal Request\"\n      }), /*#__PURE__*/_jsx(\"link\", {\n        rel: \"icon\",\n        href: \"/logo.svg\"\n      })]\n    }), isSubmitted ? /*#__PURE__*/_jsx(Confetti, {\n      width: width,\n      height: height\n    }) : null, /*#__PURE__*/_jsxs(\"main\", {\n      children: [\" \", /*#__PURE__*/_jsxs(Box, {\n        position: \"relative\",\n        children: [isSubmitted ? /*#__PURE__*/_jsx(Container, {\n          maxW: \"7xl\",\n          columns: {\n            base: 1,\n            md: 2\n          },\n          spacing: {\n            base: 10,\n            lg: 32\n          },\n          py: {\n            base: 6\n          },\n          children: /*#__PURE__*/_jsxs(Alert, {\n            status: \"success\",\n            mt: \"2\",\n            children: [/*#__PURE__*/_jsx(AlertIcon, {}), /*#__PURE__*/_jsxs(AlertDescription, {\n              mr: 2,\n              children: [\" \", \"Thank You for your Contribution \\uD83D\\uDE4F\"]\n            }), /*#__PURE__*/_jsx(CloseButton, {\n              position: \"absolute\",\n              right: \"8px\",\n              top: \"8px\",\n              onClick: function onClick() {\n                return setIsSubmitted(false);\n              }\n            })]\n          })\n        }) : null, /*#__PURE__*/_jsxs(Container, {\n          as: SimpleGrid,\n          maxW: \"7xl\",\n          columns: {\n            base: 1,\n            md: 2\n          },\n          spacing: {\n            base: 10,\n            lg: 32\n          },\n          py: {\n            base: 6\n          },\n          children: [/*#__PURE__*/_jsxs(Stack, {\n            spacing: {\n              base: 6\n            },\n            children: [/*#__PURE__*/_jsx(Heading, {\n              lineHeight: 1.1,\n              fontSize: {\n                base: \"3xl\",\n                sm: \"4xl\",\n                md: \"5xl\"\n              },\n              children: name\n            }), /*#__PURE__*/_jsx(Text, {\n              color: useColorModeValue(\"gray.500\", \"gray.200\"),\n              fontSize: {\n                base: \"lg\"\n              },\n              children: description\n            }), /*#__PURE__*/_jsxs(Link, {\n              color: \"teal.500\",\n              href: \"https://testnet.bscscan.com/address/\".concat(id),\n              isExternal: true,\n              children: [\"View on BNB Etherscan \", /*#__PURE__*/_jsx(ExternalLinkIcon, {\n                mx: \"2px\"\n              })]\n            }), /*#__PURE__*/_jsx(Box, {\n              mx: \"auto\",\n              w: \"full\",\n              children: /*#__PURE__*/_jsxs(SimpleGrid, {\n                columns: {\n                  base: 1\n                },\n                spacing: {\n                  base: 5\n                },\n                children: [/*#__PURE__*/_jsx(StatsCard, {\n                  title: \"Minimum Contribution\",\n                  stat: \"\".concat(web3.utils.fromWei(minimumContribution, \"ether\"), \" BNB ($\").concat(getWEIPriceInUSD(ETHPrice, minimumContribution), \")\"),\n                  info: \"You must contribute at least this much in Wei ( 1 BNB = 10 ^ 18 Wei) to become an approver\"\n                }), /*#__PURE__*/_jsx(StatsCard, {\n                  title: \"Wallet Address of Campaign Creator\",\n                  stat: manager,\n                  info: \"The Campaign Creator created the campaign and can create requests to withdraw money.\"\n                }), /*#__PURE__*/_jsx(StatsCard, {\n                  title: \"Number of Requests\",\n                  stat: requestsCount,\n                  info: \"A request tries to withdraw money from the contract. Requests must be approved by approvers\"\n                }), /*#__PURE__*/_jsx(StatsCard, {\n                  title: \"Number of Approvers\",\n                  stat: approversCount,\n                  info: \"Number of people who have already donated to this campaign\"\n                })]\n              })\n            })]\n          }), /*#__PURE__*/_jsxs(Stack, {\n            spacing: {\n              base: 4\n            },\n            children: [/*#__PURE__*/_jsx(Box, {\n              children: /*#__PURE__*/_jsxs(Stat, {\n                bg: useColorModeValue(\"white\", \"gray.700\"),\n                boxShadow: \"lg\",\n                rounded: \"xl\",\n                p: {\n                  base: 4,\n                  sm: 6,\n                  md: 8\n                },\n                spacing: {\n                  base: 8\n                },\n                children: [/*#__PURE__*/_jsxs(StatLabel, {\n                  fontWeight: \"medium\",\n                  children: [/*#__PURE__*/_jsxs(Text, {\n                    as: \"span\",\n                    isTruncated: true,\n                    mr: 2,\n                    children: [\" \", \"Campaign Balance\"]\n                  }), /*#__PURE__*/_jsx(Tooltip, {\n                    label: \"The balance is how much money this campaign has left to spend.\",\n                    bg: useColorModeValue(\"white\", \"gray.700\"),\n                    placement: \"top\",\n                    color: useColorModeValue(\"gray.800\", \"white\"),\n                    fontSize: \"1em\",\n                    px: \"4\",\n                    children: /*#__PURE__*/_jsx(InfoIcon, {\n                      color: useColorModeValue(\"teal.800\", \"white\")\n                    })\n                  })]\n                }), /*#__PURE__*/_jsxs(StatNumber, {\n                  children: [/*#__PURE__*/_jsxs(Box, {\n                    fontSize: \"2xl\",\n                    isTruncated: true,\n                    maxW: {\n                      base: \"\t15rem\",\n                      sm: \"sm\"\n                    },\n                    pt: \"2\",\n                    children: [/*#__PURE__*/_jsx(Text, {\n                      as: \"span\",\n                      fontWeight: \"bold\",\n                      children: balance > 0 ? web3.utils.fromWei(balance, \"ether\") : \"0, Become a Donor 😄\"\n                    }), /*#__PURE__*/_jsxs(Text, {\n                      as: \"span\",\n                      display: balance > 0 ? \"inline\" : \"none\",\n                      pr: 2,\n                      fontWeight: \"bold\",\n                      children: [\" \", \"ETH\"]\n                    }), /*#__PURE__*/_jsxs(Text, {\n                      as: \"span\",\n                      fontSize: \"lg\",\n                      display: balance > 0 ? \"inline\" : \"none\",\n                      fontWeight: \"normal\",\n                      color: useColorModeValue(\"gray.500\", \"gray.200\"),\n                      children: [\"($\", getWEIPriceInUSD(ETHPrice, balance), \")\"]\n                    })]\n                  }), /*#__PURE__*/_jsxs(Text, {\n                    fontSize: \"md\",\n                    fontWeight: \"normal\",\n                    children: [\"target of \", web3.utils.fromWei(target, \"ether\"), \" BNB ($\", getWEIPriceInUSD(ETHPrice, target), \")\"]\n                  }), /*#__PURE__*/_jsx(Progress, {\n                    colorScheme: \"teal\",\n                    size: \"sm\",\n                    value: web3.utils.fromWei(balance, \"ether\"),\n                    max: web3.utils.fromWei(target, \"ether\"),\n                    mt: 4\n                  })]\n                })]\n              })\n            }), /*#__PURE__*/_jsxs(Stack, {\n              bg: useColorModeValue(\"white\", \"gray.700\"),\n              boxShadow: \"lg\",\n              rounded: \"xl\",\n              p: {\n                base: 4,\n                sm: 6,\n                md: 8\n              },\n              spacing: {\n                base: 6\n              },\n              children: [/*#__PURE__*/_jsx(Heading, {\n                lineHeight: 1.1,\n                fontSize: {\n                  base: \"2xl\",\n                  sm: \"3xl\"\n                },\n                color: useColorModeValue(\"teal.600\", \"teal.200\"),\n                children: \"Contribute Now!\"\n              }), /*#__PURE__*/_jsx(Box, {\n                mt: 10,\n                children: /*#__PURE__*/_jsxs(\"form\", {\n                  onSubmit: handleSubmit(onSubmit),\n                  children: [/*#__PURE__*/_jsxs(FormControl, {\n                    id: \"value\",\n                    children: [/*#__PURE__*/_jsx(FormLabel, {\n                      children: \"Amount in BNB you want to contribute\"\n                    }), /*#__PURE__*/_jsxs(InputGroup, {\n                      children: [\" \", /*#__PURE__*/_jsx(Input, _objectSpread(_objectSpread({}, register(\"value\", {\n                        required: true\n                      })), {}, {\n                        type: \"number\",\n                        isDisabled: formState.isSubmitting,\n                        onChange: function onChange(e) {\n                          setAmountInUSD(Math.abs(e.target.value));\n                        },\n                        step: \"any\",\n                        min: \"0\"\n                      })), \" \", /*#__PURE__*/_jsx(InputRightAddon, {\n                        children: \"BNB\"\n                      })]\n                    }), amountInUSD ? /*#__PURE__*/_jsxs(FormHelperText, {\n                      children: [\"~$ \", getETHPriceInUSD(ETHPrice, amountInUSD)]\n                    }) : null]\n                  }), error ? /*#__PURE__*/_jsxs(Alert, {\n                    status: \"error\",\n                    mt: \"2\",\n                    children: [/*#__PURE__*/_jsx(AlertIcon, {}), /*#__PURE__*/_jsxs(AlertDescription, {\n                      mr: 2,\n                      children: [\" \", error]\n                    })]\n                  }) : null, /*#__PURE__*/_jsx(Stack, {\n                    spacing: 10,\n                    children: wallet.status === \"connected\" ? /*#__PURE__*/_jsx(Button, {\n                      fontFamily: \"heading\",\n                      mt: 4,\n                      w: \"full\",\n                      bgGradient: \"linear(to-r, teal.400,green.400)\",\n                      color: \"white\",\n                      _hover: {\n                        bgGradient: \"linear(to-r, teal.400,blue.400)\",\n                        boxShadow: \"xl\"\n                      },\n                      isLoading: formState.isSubmitting,\n                      isDisabled: amountInUSD ? false : true,\n                      type: \"submit\",\n                      children: \"Contribute\"\n                    }) : /*#__PURE__*/_jsxs(Alert, {\n                      status: \"warning\",\n                      mt: 4,\n                      children: [/*#__PURE__*/_jsx(AlertIcon, {}), /*#__PURE__*/_jsx(AlertDescription, {\n                        mr: 2,\n                        children: \"Please Connect Your Wallet to Contribute\"\n                      })]\n                    })\n                  })]\n                })\n              })]\n            }), /*#__PURE__*/_jsxs(Stack, {\n              bg: useColorModeValue(\"white\", \"gray.700\"),\n              boxShadow: \"lg\",\n              rounded: \"xl\",\n              p: {\n                base: 4,\n                sm: 6,\n                md: 8\n              },\n              spacing: 4,\n              children: [/*#__PURE__*/_jsx(NextLink, {\n                href: \"/campaign/\".concat(id, \"/requests\"),\n                children: /*#__PURE__*/_jsx(Button, {\n                  fontFamily: \"heading\",\n                  w: \"full\",\n                  bgGradient: \"linear(to-r, teal.400,green.400)\",\n                  color: \"white\",\n                  _hover: {\n                    bgGradient: \"linear(to-r, teal.400,blue.400)\",\n                    boxShadow: \"xl\"\n                  },\n                  children: \"View Withdrawal Requests\"\n                })\n              }), /*#__PURE__*/_jsx(Text, {\n                fontSize: \"sm\",\n                children: \"* You can see where these funds are being used & if you have contributed you can also approve those Withdrawal Requests :)\"\n              })]\n            })]\n          })]\n        })]\n      })]\n    })]\n  });\n}","map":null,"metadata":{},"sourceType":"module"}